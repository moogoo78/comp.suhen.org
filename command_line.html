

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Command 常用指令 &mdash; CompDocs 1.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="OS &amp; Desktop" href="os_desktop.html" />
    <link rel="prev" title="GIT" href="soft/git.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> CompDocs
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="programming.html">Programming 程式開發</a></li>
<li class="toctree-l1"><a class="reference internal" href="web_develop.html">Web Develop</a></li>
<li class="toctree-l1"><a class="reference internal" href="web_devoops.html">Web DevOops</a></li>
<li class="toctree-l1"><a class="reference internal" href="design.html">Design</a></li>
</ul>
<p class="caption"><span class="caption-text">Programming Language</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="javascript.html">JavaScript</a></li>
<li class="toctree-l1"><a class="reference internal" href="html.html">HTML</a></li>
<li class="toctree-l1"><a class="reference internal" href="css.html">CSS</a></li>
<li class="toctree-l1"><a class="reference internal" href="lua.html">Lua</a></li>
<li class="toctree-l1"><a class="reference internal" href="python.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts_matrix.html">比較</a></li>
<li class="toctree-l1"><a class="reference internal" href="python_frameworks.html">Python Web Frameworks</a></li>
</ul>
<p class="caption"><span class="caption-text">Software</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="soft/emacs.html">Emacs</a></li>
<li class="toctree-l1"><a class="reference internal" href="soft/git.html">GIT</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Command 常用指令</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#package">package</a></li>
<li class="toctree-l2"><a class="reference internal" href="#system-disk">system disk</a></li>
<li class="toctree-l2"><a class="reference internal" href="#snippets">snippets</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id1">檔案</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#compress-depress">壓縮/解壓縮 compress/depress</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#user-account">user account</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id2">網路</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ssh">SSH</a></li>
<li class="toctree-l2"><a class="reference internal" href="#service">Service</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#crontab">Crontab</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#locale">locale</a></li>
<li class="toctree-l2"><a class="reference internal" href="#vim">VIM</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pandoc">pandoc</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dot-grphviz">dot (grphviz)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ffmpeg-avconv">ffmpeg / avconv</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id3">Snippets</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="os_desktop.html">OS &amp; Desktop</a></li>
<li class="toctree-l1"><a class="reference internal" href="soft/sphinx.html">Sphinx - reST (reStructuredText)</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws_eb_flask.html">Deploying Flask (Python) to AWS Elastic Beanstalk</a></li>
<li class="toctree-l1"><a class="reference internal" href="soft/vagrant_and_docker.html">Vagrant, Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="soft/pelican.html">Pelican</a></li>
<li class="toctree-l1"><a class="reference internal" href="soft/tmux.html">tmux</a></li>
<li class="toctree-l1"><a class="reference internal" href="soft/excel.html">Excel</a></li>
<li class="toctree-l1"><a class="reference internal" href="soft/pandas.html">Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="windows-wsl.html">Windows WSL</a></li>
<li class="toctree-l1"><a class="reference internal" href="qna.html">問題解決</a></li>
</ul>
<p class="caption"><span class="caption-text">Database</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="database/database.html">Database筆記</a></li>
<li class="toctree-l1"><a class="reference internal" href="database/mysql.html">MySQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="database/postgresql.html">PostgreSQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="database/sqlite.html">SQLite</a></li>
<li class="toctree-l1"><a class="reference internal" href="database/mongodb.html">MongoDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="database/redis.html">Redis</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CompDocs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Command 常用指令</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/command_line.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="command">
<h1>Command 常用指令<a class="headerlink" href="#command" title="Permalink to this headline">¶</a></h1>
<p>macos 的 updatedb:</p>
<p>..code-block: bash</p>
<blockquote>
<div><p>sudo /usr/libexec/locate.updatedb</p>
<p>set -e # Exit immediately if a command exits with a non-zero status.</p>
</div></blockquote>
<div class="section" id="package">
<h2>package<a class="headerlink" href="#package" title="Permalink to this headline">¶</a></h2>
<p>APT:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ apt-get install foo
$ apt-get remove foo --auto-remove
$ apt-get remove foo [--purge]
$ sudo apt-get autoremove --purge
$ apt-cache policy foo # 看有什麼可以裝的版本
</pre></div>
</div>
<p>log:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">apt</span><span class="o">/</span><span class="n">term</span><span class="o">.</span><span class="n">log</span>
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">apt</span><span class="o">/</span><span class="n">history</span><span class="o">.</span><span class="n">log</span>
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">dpkg</span><span class="o">.</span><span class="n">log</span>
</pre></div>
</div>
</div>
<div class="section" id="system-disk">
<h2>system disk<a class="headerlink" href="#system-disk" title="Permalink to this headline">¶</a></h2>
<p>fdisk:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ fdisk -l
$ fdisk /dev/sdx

# 進入後用 m 看指令 (help)
</pre></div>
</div>
<p>FAT32:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ mkdosfs -F 32 -I /dev/sdb1
$ dosfslabel /dev/sdb1 &quot;NEWLABEL&quot;
</pre></div>
</div>
</div>
<div class="section" id="snippets">
<h2>snippets<a class="headerlink" href="#snippets" title="Permalink to this headline">¶</a></h2>
<p>新增目錄, 順便移動過去</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir /foo/bar <span class="o">&amp;&amp;</span> <span class="nb">cd</span> <span class="nv">$_</span>
</pre></div>
</div>
<p>複製檔案, 不用重複打兩次檔名</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cp /some/path/to/file.txt<span class="o">{</span>,.bak<span class="o">}</span>
</pre></div>
</div>
<p><a class="reference external" href="https://www.linuxjournal.com/content/bash-brace-expansion">Bash Brace Expansion | Linux Journal</a></p>
<p>把”/t”分隔的檔案轉成sql語法, 用awk和sed</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>awk -F <span class="s1">&#39;\t&#39;</span> <span class="s1">&#39;{print &quot;INSERT INTO word (\&quot;s3id\&quot;,\&quot;content\&quot;,\&quot;freq\&quot;,\&quot;translate\&quot;,\&quot;ex1\&quot;,\&quot;ex1_translate\&quot;,\&quot;ex2\&quot;,\&quot;ex2_translate\&quot;) VALUES(\&quot;&quot;$1&quot;\&quot;,\&quot;&quot;$2&quot;\&quot;,\&quot;&quot;$3&quot;\&quot;,\&quot;&quot;$4&quot;\&quot;,\&quot;&quot;$5&quot;\&quot;,\&quot;&quot;$6&quot;\&quot;,\&quot;&quot;$7&quot;\&quot;,\&quot;&quot;$8&quot;\&quot;);&quot;}&#39;</span> data_all_u.txt <span class="p">|</span> sed -e <span class="s1">&#39;s/^M//g&#39;</span> &gt; out.sql
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>先用awk轉好, 再用sed去除最後換行符號, “^M”在commend-line裡要Ctrl-V + Ctrl-M表示</p>
</div>
<p>忘記指令名稱, 但大概記得是幹嘛的</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>apropos <span class="s2">&quot;some description&quot;</span>
</pre></div>
</div>
<p>剛剛那個指令要用 sudo</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo !!
</pre></div>
</div>
<p>more</p>
<ul class="simple">
<li><p><a class="reference external" href="http://robertmuth.blogspot.tw/2012/08/better-bash-scripting-in-15-minutes.html?utm_source=hackernewsletter&amp;utm_medium=email&amp;utm_term=fav">Robert Muth: Better Bash Scripting in 15 Minutes</a></p></li>
<li><p><a class="reference external" href="http://www.grymoire.com/Unix/sed.html?utm_source=hackernewsletter&amp;utm_medium=email&amp;utm_term=code">Sed - An Introduction and Tutorial</a></p></li>
<li><p><a class="reference external" href="https://dev.to/jacobherrington/5-handy-bash-tricks-in-2-minutes-23ph?utm_source=digest_mailer&amp;utm_medium=email&amp;utm_campaign=digest_email">5 Handy Bash Tricks in 2 Minutes - DEV Community 👩‍💻👨‍💻</a></p></li>
</ul>
<p>顯示 uxxx =&gt; unicode 文字:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">echo</span> -e <span class="s2">&quot;</span><span class="k">$(</span>curl http://127.0.0.1:5000/api/info<span class="k">)</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>用 less +F 代替 tail -f (可以 Ctrl-c 跳出, F 再度回到追蹤模式)</p>
</div>
<div class="section" id="id1">
<h2>檔案<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>備份每個檔案</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> file in * <span class="p">;</span> <span class="k">do</span> cp <span class="s2">&quot;</span><span class="nv">$file</span><span class="s2">&quot;</span> <span class="s2">&quot;</span><span class="nv">$file</span><span class="s2">&quot;</span>.bak<span class="p">;</span> <span class="k">done</span>
</pre></div>
</div>
<p>把檔案foo複製到以下全部目錄裡:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ find . -type d |xargs -n 1 cp -i foo
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">xargs -n 1</dt>
<dd class="field-odd"><p>把每一行command line輸出當作一個參數</p>
</dd>
<dt class="field-even">cp -i</dt>
<dd class="field-even"><p>詢問y or n</p>
</dd>
</dl>
<p>把目錄下的檔案變成字串輸出 (jpg embedded markdown syntax):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ find *.JPG -exec echo &quot;\![](/images/nature/150214/{})&quot; \; &gt; out.txt
</pre></div>
</div>
<p>算某目錄下的檔案數目</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ find DIR_NAME -type f <span class="p">|</span> wc -l
</pre></div>
</div>
<p>把一天前更動的檔案搬到…:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ find * -mtime -1; # 找出一天內的檔案
$ find * -mtime -1 -exec mv {} PATH/TO/TARGET \; # 找出, 並搬
# mtime: 更動, -n n天內, +n n天以上, atime: 存取 (access), ctime: 修改 (change)
</pre></div>
</div>
<p>** 取出檔案的某幾行**</p>
<blockquote>
<div><p>sed -n 144827,144878p access.log</p>
</div></blockquote>
<p>把換行改成”,”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tr</span> <span class="o">-</span><span class="n">s</span> <span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span> <span class="s1">&#39;,&#39;</span> <span class="c1"># -s (squeeze), 不然會有 2 個 ,</span>
</pre></div>
</div>
<p><strong>改檔名</strong></p>
<p>大寫改小寫:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ for i in $( ls | grep [A-Z] ); do mv -i $i `echo $i | tr &#39;A-Z&#39; &#39;a-z&#39;`; done
</pre></div>
</div>
<p>只取數字, JPG改jpg:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>for i in *.JPG ; do mv &quot;$i&quot; `echo $i | tr -dc &#39;[0-9]&#39;`&quot;.jpg&quot; ; done
</pre></div>
</div>
<p>for loop:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>for f in *.html; do
    base=`basename $f .html`
    mv $f $bae.php
done
</pre></div>
</div>
<p><strong>找檔案</strong></p>
<p>複製某時間產生/修改的檔案</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>find -type f -newerct <span class="m">2020</span>-01-01 <span class="c1"># find file&#39;s create time order then 2020-01-01</span>
find -type d -not -newermt <span class="m">2020</span>-01-01 -exec -r <span class="s2">&quot;{}&quot;</span> &lt;SOMEWHERE&gt; <span class="se">\;</span> <span class="c1"># find directory&#39;s modified time less than 2020-01-01 and copy to &lt;SOMEWHERE&gt;</span>
</pre></div>
</div>
<p>找目錄名稱:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ find / -type d -name &quot;dir_name&quot;
</pre></div>
</div>
<p>刪除5分鐘內建立的檔案:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ find -cmin -5 -type f -exec rm -rf {} \;
</pre></div>
</div>
<p>找出體積最大前十檔案/目錄:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ du -a /home | sort -n -r | head -n 10
</pre></div>
</div>
<p>via: <a class="reference external" href="http://www.hkcode.com/linux-bsd-notes/693">Linux 下找出體積最大的檔案/目錄 – 網絡技術日誌</a></p>
<p>某目錄下的全部檔案的字串:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ grep -rl flaskext . |xargs sed -i -e &#39;s/flaskext/flask.ext/&#39;

$ ls *.md | xargs sed -i -e &#39;s/static\///&#39; ## 把 所有的.md (markdown) 檔裡的 &quot;static/&quot; 去掉
</pre></div>
</div>
<p>via: <a class="reference external" href="http://www.commandlinefu.com/commands/view/4698/recursive-search-and-replace-old-with-new-string-inside-files">recursive search and replace old with new string, inside files | commandlinefu.com</a></p>
<p>列出各目錄大小(不顯示子目錄):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">du</span> <span class="o">-</span><span class="n">h</span> <span class="o">|</span> <span class="n">grep</span> <span class="o">-</span><span class="n">v</span> <span class="s1">&#39;[a-z]/.&#39;</span>
</pre></div>
</div>
<p>列出各目錄大小(不顯示子目錄):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">du</span> <span class="o">-</span><span class="n">h</span> <span class="o">--</span><span class="nb">max</span><span class="o">-</span><span class="n">depth</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
<p>算檔案數量:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">find</span> <span class="p">[</span><span class="n">PATH</span><span class="p">]</span> <span class="o">-</span><span class="nb">type</span> <span class="n">f</span> <span class="o">|</span> <span class="n">wc</span> <span class="o">-</span><span class="n">l</span>
<span class="n">tree</span>
<span class="c1"># counting hidden files?</span>
</pre></div>
</div>
<p>coding convert:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># big5 to utf-8
$ iconv -f big5 -t utf-8 big5.txt -o utf8.txt

# 簡體轉繁體
$ cat test.txt | iconv -f gb2312 -t big5

# 繁體轉簡體
$ cat test.txt | iconv -f big5 -t gb2312

# Big5 編碼跟 UTF-8 編碼之間的轉換,如 UTF-8 轉 Big5
$ cat test.txt | iconv -f utf-8 -t big5
</pre></div>
</div>
<div class="section" id="compress-depress">
<h3>壓縮/解壓縮 compress/depress<a class="headerlink" href="#compress-depress" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>## tar
# compress (tar 打包, zip壓縮)
$ tar -zcvf foo.tgz foo
# decompress
$ tar -zxvf foo.tgz

$ tar -jcvf foo.tar.bz2 foo
$ tar -jxvf too.tar.bz2

## bzip2
$ bzip2 foo # 會把 foo 變成 foo.bz2
$ bzip2 -d foo.bz2 # 把 foo.bz2 變 foo
</pre></div>
</div>
<p>bzip2 的壓縮率比較大, 運算時間長</p>
<p><strong>grep:</strong></p>
<dl class="field-list simple">
<dt class="field-odd">-i</dt>
<dd class="field-odd"><p>忽略大小寫</p>
</dd>
<dt class="field-even">-n</dt>
<dd class="field-even"><p>輸出行號</p>
</dd>
<dt class="field-odd">-c</dt>
<dd class="field-odd"><p>計算次數</p>
</dd>
<dt class="field-even">-a</dt>
<dd class="field-even"><p>binary 檔用 text 檔案</p>
</dd>
<dt class="field-odd">-A</dt>
<dd class="field-odd"><p>顯示後幾行 (after)</p>
</dd>
<dt class="field-even">-B</dt>
<dd class="field-even"><p>顯示前幾行 (before)</p>
</dd>
<dt class="field-odd">-C</dt>
<dd class="field-odd"><p>顯示前後幾行</p>
</dd>
<dt class="field-even">-v</dt>
<dd class="field-even"><p>–invert-match</p>
</dd>
<dt class="field-odd">-V</dt>
<dd class="field-odd"><p>version</p>
</dd>
<dt class="field-even">-e</dt>
<dd class="field-even"><p>regex (pattern)</p>
</dd>
</dl>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ grep -r --include <span class="se">\*</span>.html foo . <span class="c1"># find foo only in html file</span>
$ grep -v -e <span class="s2">&quot;bar&quot;</span> <span class="c1"># exclude (failed)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><a class="reference external" href="http://coolshell.cn/articles/9070.html">AWK 简明教程 | 酷壳 - CoolShell.cn</a></p></li>
</ul>
</div>
</div>
<div class="section" id="user-account">
<h2>user account<a class="headerlink" href="#user-account" title="Permalink to this headline">¶</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ w <span class="c1"># user currently on the machine and thier process</span>
$ who <span class="c1"># who currently logged in</span>
$ users <span class="c1"># users,  It reads all information from /var/run/utmp file.</span>
$ last <span class="o">{</span>username<span class="o">}</span>

$ w -i <span class="c1"># display IP</span>
$ who -u <span class="c1"># display PID</span>
<span class="c1"># check utmp, wtmp man</span>

$ <span class="nb">kill</span> -HUP <span class="o">{</span>pid<span class="o">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p><a class="reference external" href="https://www.cyberciti.biz/faq/unix-linux-list-current-logged-in-users/">UNIX / Linux List Current Logged In Users - nixCraft</a></p></li>
</ul>
</div>
<div class="section" id="id2">
<h2>網路<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ lsof # list open files
$ lsof -n # network files
$ lsof -i # monitors network connections in real time
$ iftop # shows bandwith usage per *connection*
$ nethogs #shows the bandwith usage per *process*

# iOS
$ sudo lsof -i -P
$ lsof -n -i4TCP:5000 | grep LISTEN # 找出port5000
</pre></div>
</div>
<p>rsync:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ rsync --ignore-existing -avzh --delete --progress --filter=&#39;-p .DS_Store&#39; source dest
$ rsync -av /etc /tmp () # 將 /etc/ 的資料備份到 /tmp/etc 內(local)
$ rsync -av --delete src tgt # 把 src 備份到 tgt (tgt 有, src 沒有的檔案會砍掉)
$ rsync -avP # -P: --partial # (續傳, 中斷的下次再傳, --partial --progress) --progress (顯示進度)
$ rsync -av -e ssh user@host:/etc /tmp 將遠端 /etc 備份到local主機的 /tmp 內

# 傳一本停住 (不同 fs timestamp 比對問題?)
$ rsync -vrc # (不管 linux 的 permission, 用 checksum 而不是 timestamp, 比較慢)
$ rsync -Prc (P 有 process 比 v 好)
# -u: 不覆蓋比較新的檔案，只更新來源檔案時間大於目的檔案的時間
# -z: 在傳輸的過程中進行壓縮
# -c: checksum
# --inplace (target disk tmp 不夠大就要用這個)
# --bwlimit: 限制速度limit I/O bandwidth; KBytes per second
</pre></div>
</div>
<ul class="simple">
<li><p>[詳全文_資料備份同步工具簡介— rsync](<a class="reference external" href="http://newsletter.ascc.sinica.edu.tw/news/read_news.php?nid=1742">http://newsletter.ascc.sinica.edu.tw/news/read_news.php?nid=1742</a>)</p></li>
</ul>
<p>dns:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dig</span> <span class="n">foobar</span><span class="o">.</span><span class="n">com</span>        <span class="c1"># simple query</span>
<span class="n">dig</span> <span class="o">+</span><span class="n">trace</span> <span class="n">foobar</span><span class="o">.</span><span class="n">com</span> <span class="c1"># detail</span>
<span class="n">dig</span> <span class="o">+</span><span class="n">short</span> <span class="n">foobar</span><span class="o">.</span><span class="n">com</span> <span class="c1"># 不廢話</span>
<span class="n">dig</span> <span class="n">foobar</span><span class="o">.</span><span class="n">com</span> <span class="n">mx</span>
</pre></div>
</div>
<p><em>.</em> 表示the root of the hierarchy</p>
<ul class="simple">
<li><p><a class="reference external" href="http://blog.longwin.com.tw/2010/02/netstat-check-connect-2010/">使用 netstat 找出不正常的連線 | Tsung’s Blog</a></p></li>
</ul>
<p>curl:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">example</span><span class="o">.</span><span class="n">com</span>
<span class="n">curl</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">example</span> <span class="o">-</span><span class="n">d</span><span class="s2">&quot;tag=foo&amp;cat=bar&quot;</span> <span class="c1"># 這個預設會送POST</span>
<span class="n">curl</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">example</span><span class="o">/</span><span class="n">edit</span> <span class="o">-</span><span class="n">XPOST</span> <span class="c1"># http method</span>
<span class="n">crul</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">example</span><span class="o">/</span><span class="n">api</span> <span class="o">-</span><span class="n">F</span> <span class="n">user</span><span class="o">=</span><span class="n">mouse</span> <span class="o">-</span><span class="n">F</span> <span class="n">passwd</span><span class="o">=</span><span class="n">cheese</span>
<span class="n">curl</span> <span class="o">--</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">F</span> <span class="s2">&quot;foo=bar&quot;</span> <span class="o">-</span><span class="n">F</span> <span class="s2">&quot;myfile=@pathto.local&quot;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">upload</span> <span class="c1"># 上傳檔案</span>

<span class="p">:</span><span class="o">-</span><span class="n">X</span><span class="p">:</span>  <span class="n">specify</span> <span class="n">HTTP</span> <span class="n">request</span> <span class="n">method</span> <span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="n">POST</span>
<span class="p">:</span><span class="o">-</span><span class="n">H</span><span class="p">:</span>  <span class="n">specify</span> <span class="n">request</span> <span class="n">headers</span> <span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="s2">&quot;Content-type: application/json&quot;</span>
<span class="p">:</span><span class="o">-</span><span class="n">d</span><span class="p">:</span>  <span class="n">specify</span> <span class="n">request</span> <span class="n">data</span> <span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="s1">&#39;{&quot;message&quot;:&quot;Hello Data&quot;}&#39;</span>
<span class="p">:</span><span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">binary</span><span class="p">:</span>       <span class="n">specify</span> <span class="n">binary</span> <span class="n">request</span> <span class="n">data</span> <span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="nd">@file</span><span class="o">.</span><span class="n">bin</span>
<span class="p">:</span><span class="o">-</span><span class="n">i</span><span class="p">:</span>  <span class="n">shows</span> <span class="n">the</span> <span class="n">response</span> <span class="n">headers</span>
<span class="p">:</span><span class="o">-</span><span class="n">u</span><span class="p">:</span>  <span class="n">specify</span> <span class="n">username</span> <span class="ow">and</span> <span class="n">password</span> <span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="s2">&quot;admin:secret&quot;</span>
<span class="p">:</span><span class="o">-</span><span class="n">v</span><span class="p">:</span>  <span class="n">enables</span> <span class="n">verbose</span> <span class="n">mode</span> <span class="n">which</span> <span class="n">outputs</span> <span class="n">info</span> <span class="n">such</span> <span class="k">as</span> <span class="n">request</span> <span class="ow">and</span> <span class="n">response</span> <span class="n">headers</span> <span class="ow">and</span> <span class="n">errors</span>
</pre></div>
</div>
<p>wget:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="o">-</span><span class="n">i</span> <span class="n">url_list</span><span class="o">.</span><span class="n">txt</span> <span class="c1"># 下載文字檔內的 url</span>
</pre></div>
</div>
</div>
<div class="section" id="ssh">
<h2>SSH<a class="headerlink" href="#ssh" title="Permalink to this headline">¶</a></h2>
<p>create id_rsa, id_rsa.pub:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ssh</span><span class="o">-</span><span class="n">keygen</span> <span class="o">-</span><span class="n">t</span> <span class="n">rsa</span>
</pre></div>
</div>
<p>.ssh/config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Host</span> <span class="n">qll</span><span class="o">-</span><span class="n">staging</span>
    <span class="n">HostName</span> <span class="mf">123.123</span><span class="o">.</span><span class="mf">123.123</span>
    <span class="n">Port</span> <span class="mi">22</span>
    <span class="n">IdentityFile</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">foo</span><span class="o">.</span><span class="n">pem</span>
    <span class="n">User</span> <span class="n">ec2</span><span class="o">-</span><span class="n">user</span>

<span class="n">Host</span> <span class="n">bitbucket</span><span class="o">-</span><span class="n">moogoo</span>
    <span class="n">HostName</span> <span class="n">bitbucket</span><span class="o">.</span><span class="n">org</span>
    <span class="n">User</span> <span class="n">git</span>
    <span class="n">PreferredAuthentications</span> <span class="n">publickey</span>
    <span class="n">IdentityFile</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">id_rsa</span><span class="o">-</span><span class="n">bitbucket</span>
    <span class="n">IdentitiesOnly</span> <span class="n">yes</span>
</pre></div>
</div>
</div>
<div class="section" id="service">
<h2>Service<a class="headerlink" href="#service" title="Permalink to this headline">¶</a></h2>
<p>關掉uwsgi的process:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ps</span> <span class="n">ca</span><span class="o">|</span><span class="n">grep</span> <span class="n">uwsgi</span> <span class="o">|</span><span class="n">awk</span> <span class="s1">&#39;{ print $1}&#39;</span> <span class="o">|</span> <span class="n">xargs</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">run</span><span class="o">-</span><span class="k">if</span><span class="o">-</span><span class="n">empty</span> <span class="n">sudo</span> <span class="n">kill</span> <span class="o">-</span><span class="mi">9</span>
</pre></div>
</div>
<p>快速靜態檔案server:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python -m SimpleHTTPServer 8080
</pre></div>
</div>
<div class="section" id="crontab">
<h3>Crontab<a class="headerlink" href="#crontab" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://crontab.guru/">crontab.guru - the cron schedule expression editor</a></p>
<p>分鐘 小時 日期 月份 週</p>
<p>每5min一次:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*/</span><span class="mi">5</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">moogoo</span><span class="o">/</span><span class="n">test</span><span class="o">.</span><span class="n">sh</span>
<span class="mi">5</span> <span class="mi">0</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>
</pre></div>
</div>
<p>每小時:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">01</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">moogoo</span><span class="o">/</span><span class="n">test</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>每天(半夜):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="mi">0</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>
</pre></div>
</div>
<p>每週:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="mi">0</span> <span class="o">*</span> <span class="o">*</span> <span class="mi">0</span>
</pre></div>
</div>
<p>每月:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="o">*</span> <span class="o">*</span>
</pre></div>
</div>
<p>start:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">service</span> <span class="n">crond</span> <span class="n">start</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="locale">
<h2>locale<a class="headerlink" href="#locale" title="Permalink to this headline">¶</a></h2>
<p>語系:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ locale -a # 目前系統支援語系
$ dpkg-reconfigure locales 安裝語系


$ export LC_ALL=&quot;en_US.UTF-8&quot;
$ export LC_CTYPE=&quot;en_US.UTF-8&quot;
$ sudo dpkg-reconfigure locales
</pre></div>
</div>
</div>
<div class="section" id="vim">
<h2>VIM<a class="headerlink" href="#vim" title="Permalink to this headline">¶</a></h2>
<p>行號:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">:</span><span class="nb">set</span> <span class="n">nonu</span>
<span class="p">:</span><span class="nb">set</span> <span class="n">nu</span>
</pre></div>
</div>
<p>vim硬是要存檔:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>:w !sudo tee %
</pre></div>
</div>
<p>replace tabs with single space:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">:</span><span class="o">%</span><span class="n">s</span><span class="o">/</span>\<span class="n">t</span><span class="o">/</span> <span class="o">/</span><span class="n">g</span>
</pre></div>
</div>
</div>
<div class="section" id="pandoc">
<h2>pandoc<a class="headerlink" href="#pandoc" title="Permalink to this headline">¶</a></h2>
<p>轉換各種檔案格式</p>
<p>ex: markdown 轉 rst</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pandoc -f markdown -t rst -o output.rst input.md
</pre></div>
</div>
</div>
<div class="section" id="dot-grphviz">
<h2>dot (grphviz)<a class="headerlink" href="#dot-grphviz" title="Permalink to this headline">¶</a></h2>
<p>example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">digraph</span> <span class="n">foo</span> <span class="p">{</span>
  <span class="n">hello</span> <span class="p">[</span><span class="n">shape</span><span class="o">=</span><span class="s2">&quot;diamond&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;hihi </span><span class="se">\n</span><span class="s2">hello&quot;</span><span class="p">]</span>
  <span class="n">world</span>
  <span class="n">hello</span> <span class="o">-&gt;</span> <span class="n">world</span> <span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Y&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>輸出png:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dot</span> <span class="n">foo</span><span class="o">.</span><span class="n">dot</span> <span class="o">-</span><span class="n">Tpng</span> <span class="o">-</span><span class="n">o</span> <span class="n">foo</span><span class="o">.</span><span class="n">png</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>-T: format -o: output</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>註解用/* */ 或 //，像C++一樣</p>
</div>
<p>ref:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://www.graphviz.org/content/node-shapes">Node Shapes | Graphviz - Graph Visualization Software</a></p></li>
<li><p><a class="reference external" href="http://www.graphviz.org/content/dot-language">The DOT Language | Graphviz - Graph Visualization Software</a></p></li>
<li><p><a class="reference external" href="http://www.graphviz.org/Gallery.php">Gallery | Graphviz - Graph Visualization Software</a></p></li>
</ul>
</div>
<div class="section" id="ffmpeg-avconv">
<h2>ffmpeg / avconv<a class="headerlink" href="#ffmpeg-avconv" title="Permalink to this headline">¶</a></h2>
<p>debian 改用 avconv (apt-get install libav-tools)</p>
<p><a class="reference external" href="http://superuser.com/questions/286675/how-to-install-ffmpeg-on-debian">How to install FFmpeg on Debian? - Super User</a></p>
<p>usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ffmpeg</span> <span class="o">-</span><span class="n">i</span> <span class="p">[</span><span class="n">source</span><span class="p">]</span> <span class="p">[</span><span class="n">target</span><span class="p">]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>-vcodec</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>-s 100x100</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>-t 10 (前10秒)</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>-vf crop=100:100 (切中間100x100), crop=in_w-480:in_h(左右各切240)</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>-aspect 4:3</p>
</div>
<p>列出所有codecs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ffmpeg -codecs
</pre></div>
</div>
<p>列出所有file format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ffmpeg -formats
</pre></div>
</div>
<div class="section" id="id3">
<h3>Snippets<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p><strong>convert:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ffmpeg -i filename.webm -acodec libmp3lame -aq <span class="m">4</span> filename.mp3

<span class="c1"># convert MTS to mp4</span>
$ ffmpeg -i <span class="m">00026</span>.MTS -vcodec mpeg4 -b:v 10M -acodec libfaac -b:a 192k out.mp4
$ ffmpeg -i input.MTS -s hd720 -b 6000k -ar <span class="m">44100</span> -ab 224k -ac <span class="m">2</span> output.mp4
</pre></div>
</div>
<p><strong>meta data:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># show meta data</span>
$ ffmpeg -i &lt;foo.mp4&gt; -f ffmetadata &lt;out.txt&gt;

$ ffprobe
</pre></div>
</div>
<p><strong>manuplate:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># clip movie range, from 00:45:00 to 00:48:00 (經過 3 分鐘)</span>
$ ffmpeg -i <span class="m">00026</span>.MTS -vcodec mpeg4 -b:v 10M -acodec libfaac -b:a 192k -ss <span class="m">00</span>:45:00.0 -t <span class="m">00</span>:03:00.0 out.mp4

<span class="c1"># video 右上角加 watermark:</span>
$ ffmpeg –i inputvideo.avi -vf <span class="s2">&quot;movie=watermarklogo.png [watermark]; [in][watermark] overlay=main_w-overlay_w-10:10 [out]&quot;</span> outputvideo.flv
</pre></div>
</div>
<p>via: <a class="reference external" href="http://www.idude.net/index.php/how-to-watermark-a-video-using-ffmpeg/">How to watermark a video using FFmpeg | iDude.net</a></p>
<p><strong>聲音:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#聲音檔前面加 1 秒靜音:</span>
$ ffmpeg -f lavfi -i <span class="nv">aevalsrc</span><span class="o">=</span><span class="m">0</span>:0:0:0:0:0::duration<span class="o">=</span><span class="m">1</span> silence.mp3 <span class="c1"># 產生 1 秒靜音 mp3</span>
$ ffmpeg -i concat:<span class="s2">&quot;silence.mp3|original.mp3&quot;</span> -codec copy combined.mp3 <span class="c1"># 合併</span>

<span class="c1"># 大小聲</span>
$ ffmpeg -i silent.mp3 -af <span class="s2">&quot;volume=10dB&quot;</span> noise.mp3
$ ffmpeg -i silent.mp3 -af <span class="s2">&quot;volume=-5dB&quot;</span> noise.mp3
$ ffmpeg -f inputfile -vcodec copy -af <span class="s2">&quot;volume/10dB&quot;</span> outputfile

<span class="c1"># 剪接</span>
$ ffmpeg -ss <span class="m">23</span>:05 -t <span class="m">8</span>:20 -i file.mp3 out.mp3 <span class="c1"># 從 23 分 5 秒開始, 剪 9 分 20 秒的內容</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="os_desktop.html" class="btn btn-neutral float-right" title="OS &amp; Desktop" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="soft/git.html" class="btn btn-neutral float-left" title="GIT" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2015, Suhen

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>